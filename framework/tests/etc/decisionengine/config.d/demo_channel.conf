{
'sources'  : {
    # Glideinwms frontend configuration
    'fe_config': {
        'module' :  'modules.glideinwms.s_fe_config',
        'name'   :  'FrontendConfiguration',
        'parameters': {
         },
        'schedule': 60,
    },
    # Source to get job classads
    'jobs_manifests' : {
        'module' :  'modules.htcondor.s_job_q',
        'name'   :  'JobQ',
        'parameters': {
            'condor_config': '/etc/condor/condor_config',
            'collector_host': 'cmssrv274.fnal.gov',
            'schedds': ['cmsgwms-submit6.fnal.gov'],
            'constraint': 'stringListsIntersect("T3_US_NERSC,T3_US_HEPCloud,FNAL", DESIRED_Sites)',
            'classad_attrs': ['ClusterId', 'ProcId', 'JobStatus', 'VO_Name', 'CMS_JobType', 'DESIRED_Sites', 'RequestCpus', 'RequestMemory', 'RemoteHost', 'GlobalJobId', 'JobUniverse', 'QDate', 'RemoteSlotID', 'RequestMemory', 'x509userproxy', 'x509UserProxyFQAN', 'x509UserProxySubject', 'EnteredCurrentStatus', 'ServerTime', 'x509UserProxyFirstFQAN']
        },
        'schedule': 60,
    },
    # Source to get startds/slots in the cluster
    'startd_manifests' : {
        'module' :  'modules.htcondor.s_slots',
        'name'   :  'StartdManifests',
        'parameters': {
            'condor_config': '/etc/condor/condor_config',
            'collector_host': 'cmssrv274.fnal.gov',
        },
        'schedule': 60,
    },
    # Source to get factory entries
    'factory_entry_manifests' : {
        'module' :  'modules.glideinwms.s_factory_entries',
        'name'   :  'FactoryEntries',
        'parameters': {
            'condor_config': '/etc/condor/condor_config',
            'collector_host': 'fermifactory01.fnal.gov',

            #'constraint': 'stringListsIntersect("T3_US_HEPCloud", GLIDEIN_CMSSite) && stringListsIntersect("HEPCloud_CMS,CMS", GLIDEIN_Supported_VOs)'

            #'constraint': 'stringListsIntersect("T1_US_FNAL", GLIDEIN_CMSSite) && stringListsIntersect("HEPCloud_CMS,CMS", GLIDEIN_Supported_VOs)'

            #'constraint': 'stringListsIntersect("T3_US_NERSC", GLIDEIN_Site) && stringListsIntersect("HEPCloud_CMS,CMS", GLIDEIN_Supported_VOs)',

            #'constraint': 'stringListsIntersect("T3_US_NERSC,T3_US_HEPCloud,T1_US_FNAL", GLIDEIN_Site) && stringListsIntersect("HEPCloud_CMS,CMS", GLIDEIN_Supported_VOs)',

            'constraint': 'stringListsIntersect("T3_US_NERSC,T3_US_HEPCloud,FNAL", GLIDEIN_Site) && stringListsIntersect("HEPCloud_CMS,CMS", GLIDEIN_Supported_VOs)'
        },
        'schedule': 60,
    },
    # Source to get factory global
    'factory_global_manifests' : {
        'module' :  'modules.glideinwms.s_factory_global',
        'name'   :  'FactoryGlobalManifests',
        'parameters': {
            'condor_config': '/etc/condor/condor_config',
            'collector_host': 'fermifactory01.fnal.gov',
        },
        'schedule': 60,
    },
},
'transforms': {
    'glideinwms_requests': {
        'module' : 'modules.glideinwms.t_glidein_requests',
        'name'   : 'GlideinRequestManifests',
        'parameters': {
            'accounting_group': 'CMS',
            'fe_config_group': 'opportunistic',
            'job_filter': 'ClusterId > 0',
        }   
    }
},
'logicengines': {
    'logicengine1' : {
        'module' : 'framework.logicengine.LogicEngine',
        'name' : 'LogicEngine',
        'parameters' : {
            'rules': {
                'publish_glidein_requests': {
                    'expression':'(allow_hpc)',
                    'actions': ['glideclientglobal_manifests', 'glideclient_manifests'],
                    #'actions': ['GlideClientManifests', 'GlideClientGlobalManifests'],
                    'facts':['allow_hpc'],
                },
            },
            'facts': {
                'allow_hpc': '(True)'
            },
        }
    }
},
'publishers': {
    'glideclientglobal_manifests': {
        'module' :  'modules.glideinwms.p_glideclientglobal',
        'name'   :  'GlideClientGlobalManifests',
        'parameters': {
            'condor_config': '/etc/condor/condor_config',
            'x509_user_proxy': '/etc/gwms-frontend/fe_proxy',
            #'collector_host': 'fermifactory01.fnal.gov',
            #'constraint': 'stringListsIntersect("T3_US_NERSC", GLIDEIN_Site)'
        },
    },
    'glideclient_manifests': {
        'module' :  'modules.glideinwms.p_glideclient',
        'name'   :  'GlideClientManifests',
        'parameters': {
            'condor_config': '/etc/condor/condor_config',
            'x509_user_proxy': '/etc/gwms-frontend/fe_proxy',
            #'collector_host': 'fermifactory01.fnal.gov',
            #'constraint': 'stringListsIntersect("T3_US_NERSC", GLIDEIN_Site)'
        },
    },
}
}
